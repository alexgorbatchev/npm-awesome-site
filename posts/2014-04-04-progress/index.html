<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xmlns:fb="https://www.facebook.com/2008/fbml"><head><meta charset="utf-8"><link rel="alternate" title="RSS" type="application/rss+xml" href="http://feeds.feedburner.com/npmawesome"><link href="http://npmawesome.com/atom.xml" title="Blog Posts" type="application/atom+xml" rel="alternate"><link rel="stylesheet" type="text/css" media="all" href="/styles.css"><meta name="viewport" content="initial-scale=1, maximum-scale=1"><meta property="twitter:account_id" content="4503599628039784"><meta property="fb:app_id" content="1425631694354948"><title>progress</title><meta property="og:title" content="npm awesome"><meta property="og:image" content="http://npmawesome.com/images/default-share-image.jpg"><meta property="og:updated_time" content="1396635957000"><meta property="og:site_name" content="npm awesome"><meta property="og:type" content="article"><meta property="og:url" content="http://npmawesome.com/posts/2014-04-04-progress"><meta property="og:description" content="Progress indication for CLI applications with progress module."><link rel="canonical" href="http://npmawesome.com/posts/2014-04-04-progress"><meta name="description" content="Progress indication for CLI applications with progress module."></head></html><body><header id="page-header"><div class="container"><div class="row"><h1 id="logo"><a href="/"><span class="name">npmawesome</span><span class="posts-counter">88</span></a></h1><div id="sub-title"><a href="http://npmjs.org">npm</a> picks, old and new.
<a href="https://github.com/alexgorbatchev/npm-awesome-site">Fork on GitHub to contribute</a></div></div></div></header><div class="container"><div class="row"><div class="main col"><article><header><h2 class="npm"><a href="/posts/2014-04-04-progress">progress</a></h2><div class="meta"><span>posted by <a href="https://github.com/alexgorbatchev">Alex Gorbatchev</a> on April 4th 2014</span><a href="http://npmawesome.com/posts/2014-04-04-progress#disqus_thread" class="comments"></a><div data-github-repo="visionmedia/node-progress" class="github-stars"></div></div><div class="social-box"><div data-url="http://npmawesome.com/posts/2014-04-04-progress" class="social"></div></div></header><div class="content"><div class="highlight nodejitsu"><img src="/images/posts/nodejitsu.png" style="height: 80px" class="hide-on-mobile"/><span>This post was written for <a href="http://nodejitsu.com">Nodejitsu</a> blog and is crossposted here.
<a href="http://nodejitsu.com">Nodejitsu</a> loved what I was doing at <a href="http://npmawesome.com">npmawesome.com</a>
and is now supporting the project.</span></div><p>Lets talk about long running CLI (command line interface) applications. When you have a finite process that is expected to take some time, the best thing to do is to let your users know about it. A typical application that for example downloads a file might look like this</p>
<pre><code>var
  request = require(&#39;request&#39;),
  fs = require(&#39;fs&#39;)
  ;

process.stdout.write(&#39;Downloading... &#39;);

request(&#39;http://nodejs.org/dist/node-0.0.1.tar.gz&#39;)
  .pipe(fs.createWriteStream(__dirname + &#39;/node.tar.gz&#39;))
  .on(&#39;close&#39;, function (err) {
    process.stdout.write(&#39;done!\n&#39;);
  });
</code></pre><p>The user experience is hardly a great one. It&#39;s clear that something is happening, or at least expected to be happening.</p>
<div class="read-more"></div>

<div style="padding: 13px 10px 10px; background: black; text-align: center; border-radius: 3px"><img src="http://npmawesome.com/images/posts/progress/progress01.gif"/></div>

<p>It&#39;s not really clear if it&#39;s still happening. Is it time for <code>ctrl+c</code> yet? How about an indicator that something is actually going on?</p>
<pre><code>process.stdout.write(&#39;Downloading...&#39;);
intervalId = setInterval(function() { process.stdout.write(&#39;.&#39;); }, 1000);

request(&#39;http://nodejs.org/dist/node-0.0.1.tar.gz&#39;)
  .pipe(fs.createWriteStream(__dirname + &#39;/node.tar.gz&#39;))
  .on(&#39;close&#39;, function (err) {
    process.stdout.write(&#39; done!\n&#39;);
    clearInterval(intervalId);
  });
</code></pre><div style="padding: 13px 10px 10px; background: black; text-align: center; border-radius: 3px"><img src="http://npmawesome.com/images/posts/progress/progress02.gif"/></div>

<p><img class="hide-on-mobile" src="https://avatars2.githubusercontent.com/u/25254" style="float: right; margin-left: 1em; width: 100px"/>
A little better. But still, there&#39;s no way of telling how long the process will actually take. Lets just do a real progress bar, shall we? This is where <a href="https://github.com/visionmedia/node-progress">progress</a> module that was originally started by <a href="https://github.com/visionmedia">TJ Holowaychuk</a> comes into play! Due to the awesomeness of open source, <a href="https://github.com/visionmedia/node-progress">progress</a> is now pretty much a community effort.</p>
<pre><code>npm install progress
</code></pre><h2 id="features">Features</h2>
<p><a href="https://github.com/visionmedia/node-progress">progress</a> supports a wide range of options via the format string and options. In the end will get a good looking ASCII progress bar and that will let everyone know about the true progress in your CLI application.</p>
<p>These are the tokens you can use to format your progress bar:</p>
<ul>
<li><code>:bar</code> the progress bar itself</li>
<li><code>:current</code> current tick number</li>
<li><code>:total</code> total ticks</li>
<li><code>:elapsed</code> time elapsed in seconds</li>
<li><code>:percent</code> completion percentage</li>
<li><code>:eta</code> estimated completion time in seconds</li>
</ul>
<h2 id="usage">Usage</h2>
<p>Lets modify our original example and put <a href="https://github.com/visionmedia/node-progress">progress</a> to a good use:</p>
<pre><code>var
  request = require(&#39;request&#39;),
  ProgressBar = require(&#39;progress&#39;),
  fs = require(&#39;fs&#39;)
  ;

var
  req = request(&#39;http://nodejs.org/dist/node-0.0.1.tar.gz&#39;),
  bar
  ;

req
  .on(&#39;data&#39;, function (chunk) {
    bar = bar || new ProgressBar(&#39;Downloading... [:bar] :percent :etas&#39;, {
      complete: &#39;=&#39;,
      incomplete: &#39; &#39;,
      width: 25,
      total: parseInt(req.response.headers[&#39;content-length&#39;])
    });

    bar.tick(chunk.length);
  })
  .pipe(fs.createWriteStream(__dirname + &#39;/node.tar.gz&#39;))
  .on(&#39;close&#39;, function (err) {
    bar.tick(bar.total - bar.curr);
  })
  ;
</code></pre><div style="padding: 13px 10px 10px; background: black; text-align: center; border-radius: 3px"><img src="http://npmawesome.com/images/posts/progress/progress03.gif"/></div>

<p>We even get ETA estimate for free. That&#39;s what I&#39;m talking about!</p>
<h2 id="other-modules-to-checkout">Other modules to checkout</h2>
<p>Here are a few other modules to check out:</p>
<ul>
<li><a href="https://github.com/jclulow/node-progbar">progbar</a> by <a href="https://github.com/jclulow">Joshua M. Clulow</a> is a straight up alternative.</li>
<li><a href="https://github.com/bevry/progressbar">progressbar</a> by <a href="https://github.com/balupton">Benjamin Arthur Lupton</a> extends <a href="https://github.com/visionmedia/node-progress">progress</a> with chaining, domains, and steps.</li>
<li><a href="https://github.com/Unitech/node-multimeter">pm2-multimeter</a> originally by <a href="https://github.com/substack">James Halliday</a> and now up kept by <a href="https://github.com/Unitech">Alexandre Strzelewicz</a> can display multiple progress bars at the same time.</li>
</ul>
<h2 id="closing-thoughts">Closing thoughts</h2>
<p>It&#39;s really cool to see a CLI application giving meaningful progress feedback. Please don&#39;t forget about user experience when building tools.</p>
</div></article><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'npmawesome'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script></div><aside class="col"><div class="feedburner"><a href="http://feeds.feedburner.com/npmawesome"><img src="/images/feed.gif"></a></div><div class="other-posts"><h4>Previously...</h4><div><a href="/posts/2014-05-13-links">Links for May 13, 2014</a></div><div><a href="/posts/2014-05-06-agenda" class="partner nodejitsu">agenda</a></div><div><a href="/posts/2014-05-06-links">Links for May 6, 2014</a></div><div><a href="/posts/2014-05-01-google-distance">google-distance</a></div><div><a href="/posts/2014-04-30-links">Links for Apr 30, 2014</a></div><div><a href="/posts/2014-04-30-sentiment" class="partner nodejitsu">sentiment</a></div><div><a href="/posts/2014-04-29-compare-express-restify-hapi-loopback" class="partner strongloop">Comparing Express, Restify, hapi and LoopBack for building RESTful APIs</a></div><div><a href="/posts/2014-04-28-angular-injector">angular-injector</a></div><div><a href="/posts/2014-04-23-platform-js">platform.js</a></div><div><a href="/posts/2014-04-23-links">Links for Apr 23, 2014</a></div><div><a href="/posts/2014-04-19-links">Links for Apr 19, 2014</a></div><div><a href="/posts/2014-04-18-links">Links for Apr 18, 2014</a></div><div><a href="/posts/2014-04-18-terminal-menu" class="partner nodejitsu">terminal-menu</a></div><div><a href="/posts/2014-04-17-links">Links for Apr 17, 2014</a></div><div><a href="/posts/2014-04-16-promises-trycatch-zones" class="partner strongloop">Comparing Node.js Promises, Try/Catch, Angular Zone.js and yes, Zone</a></div><div><a href="/posts/2014-04-15-links">Links for Apr 15, 2014</a></div><div><a href="/posts/2014-04-11-links">Links for Apr 10, 2014</a></div><div><a href="/posts/2014-04-10-shmock">shmock</a></div><div><a href="/posts/2014-04-09-links">Links for Apr 8, 2014</a></div><div><a href="/posts/2014-04-07-links">Links for Apr 7, 2014</a></div><div><a href="/posts/2014-04-04-links">Links for Apr 5, 2014</a></div><div><a href="/posts/2014-04-04-progress" class="current partner nodejitsu">progress</a></div><div><a href="/posts/2014-04-04-slate-irc">slate-irc</a></div><div><a href="/posts/2014-04-03-links">Links for Apr 4, 2014</a></div><div><a href="/posts/2014-03-28-cli-table" class="partner nodejitsu">cli-table</a></div><div><a href="/posts/2014-03-21-yargs" class="partner nodejitsu">yargs</a></div><div><a href="/posts/2014-03-12-convict" class="partner nodejitsu">convict</a></div><div><a href="/posts/2014-03-06-lockit" class="partner nodejitsu">lockit</a></div><div><a href="/posts/2014-02-27-qr-image" class="partner nodejitsu">qr-image</a></div><div><a href="/posts/2014-02-25-webdriverjs">webdriver.js</a></div><div><a href="/posts/2014-02-24-pretty-error">pretty-error</a></div><div><a href="/posts/2014-02-21-supertest">supertest</a></div><div><a href="/posts/2014-02-20-spritesmith">spritesmith</a></div><div><a href="/posts/2014-02-19-9-gulp-js-plugins-for-a-great-build-system" class="partner nodejitsu">9 gulp.js plugins for a great build system</a></div><div><a href="/posts/2014-02-18-npm-diff">npm-diff</a></div><div><a href="/posts/2014-02-17-nodepdf">NodePDF</a></div><div><a href="/posts/2014-02-13-domain-context">domain-context</a></div><div><a href="/posts/2014-02-12-jsonstream">JSONStream</a></div><div><a href="/posts/2014-02-11-peer-js">peer.js</a></div><div><a href="/posts/2014-02-10-node-dependencies">node-dependencies</a></div><div><a href="/posts/2014-02-05-cucumber-js">cucumber.js</a></div><div><a href="/posts/2014-02-04-binary-js">binary.js</a></div><div><a href="/posts/2014-02-03-power-assert">power-assert</a></div><div><a href="/posts/2014-01-31-coupon-code">coupon-code</a></div><div><a href="/posts/2014-01-30-rewire">rewire</a></div><div><a href="/posts/2014-01-29-yarm">yarm</a></div><div><a href="/posts/2014-01-28-modella">modella</a></div><div><a href="/posts/2014-01-27-mversion">mversion</a></div><div><a href="/posts/2014-01-24-schema-inspector">schema-inspector</a></div><div><a href="/posts/2014-01-23-oboe-js">oboe.js</a></div><div><a href="/posts/2014-01-22-autoprefixer">autoprefixer</a></div><div><a href="/posts/2014-01-21-js-yaml">js-yaml</a></div><div><a href="/posts/2014-01-17-gaze">gaze</a></div><div><a href="/posts/2014-01-14-shortid">shortId</a></div><div><a href="/posts/2014-01-13-testium">testium</a></div><div><a href="/posts/2014-01-10-messageformat">messageformat.js</a></div><div><a href="/posts/2014-01-09-gulp">gulp</a></div><div><a href="/posts/2014-01-06-chalk">chalk</a></div><div><a href="/posts/2013-12-31-recluster">recluster</a></div><div><a href="/posts/2013-12-30-rework">rework</a></div><div><a href="/posts/2013-12-27-cheerio">cheerio</a></div><div><a href="/posts/2013-12-19-dat">dat</a></div><div><a href="/posts/2013-12-18-xregexp">xregexp</a></div><div><a href="/posts/2013-12-17-npm">npm v1.3.18</a></div><div><a href="/posts/2013-12-16-ect">ect</a></div><div><a href="/posts/2013-12-13-chrono">chrono</a></div><div><a href="/posts/2013-12-11-prettyjson">prettyjson</a></div><div><a href="/posts/2013-12-10-state">state</a></div><div><a href="/posts/2013-12-09-blessed">blessed</a></div><div><a href="/posts/2013-12-05-gm">gm</a></div><div><a href="/posts/2013-12-03-nak">nak</a></div><div><a href="/posts/2013-12-03-verymodel">VeryModel</a></div><div><a href="/posts/2013-11-30-scala-js">scala.js</a></div><div><a href="/posts/2013-11-27-scale-npm">scalenpm.org</a></div><div><a href="/posts/2013-11-26-rx-js">rx.js</a></div><div><a href="/posts/2013-11-26-docpad">docpad</a></div><div><a href="/posts/2013-11-25-grunt-angular-builder">grunt-angular-builder</a></div><div><a href="/posts/2013-11-22-videoconverter-js">videoconverter.js</a></div><div><a href="/posts/2013-11-22-event-stream">event-stream</a></div><div><a href="/posts/2013-11-21-bacon-js">bacon.js</a></div><div><a href="/posts/2013-11-20-spdy">node-spdy</a></div><div><a href="/posts/2013-11-19-json-mask">json-mask</a></div><div><a href="/posts/2013-11-18-pm2">pm2</a></div><div><a href="/posts/2013-11-18-npmd">npmd</a></div><div><a href="/posts/2013-11-18-nixt">nixt</a></div><div><a href="/posts/2013-11-17-vm-js">vm.js</a></div><div><a href="/posts/2013-11-17-node-jvm">node-jvm</a></div><div><a href="/posts/2013-11-17-flake">flake</a></div></div></aside></div></div><a id="fork-me" href="https://github.com/alexgorbatchev/npm-awesome-site" class="hide-on-mobile">Fork Me</a><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

// http://drawingablank.me/blog/fix-your-bounce-rate.html
// https://news.ycombinator.com/item?id=5766883
setTimeout(function() { ga('send', 'event', 'read', 'auto generated'); }, 5000);

ga('create', 'UA-46164085-1', 'npmawesome.com');
ga('send', 'pageview');
</script><div id="fb-root"></div><script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=1425631694354948";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script><script>/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'npmawesome'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script><script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script async src="/scripts/npmawesome.min.js"></script><script async src="//platform.twitter.com/widgets.js"></script><script async src="https://apis.google.com/js/plusone.js" parsetags="explicit"></script></body>