<!DOCTYPE html><head><link rel="alternate" title="RSS" type="application/rss+xml" href="http://feeds.feedburner.com/npmawesome"><link href="&lt;%= @site.url %&gt;/atom.xml" title="Blog Posts" type="application/atom+xml" rel="alternate"><link rel="stylesheet" type="text/css" media="all" href="/styles.css"><meta name="viewport" content="initial-scale=1, maximum-scale=1"><meta property="twitter:account_id" content="4503599628039784"><meta charset="utf-8"><title>lockit | npm awesome</title><meta property="og:title" content="lockit"><meta property="og:updated_time" content="1394127358000"><meta property="og:site_name" content="npm awesome"><meta property="og:type" content="blog"><meta property="og:url" content="http://npmawesome.com/posts/2014-03-06-lockit"><meta name="description" content="Lockit is an authentication solution for Express."><meta property="og:description" content="Lockit is an authentication solution for Express."></head><body><div class="container"><div class="row"><h1 id="logo"><a href="/"><span>npmawesome</span><span class="posts-counter">64</span></a></h1><div id="sub-title"><a href="http://npmjs.org">npm</a> picks, old and new.
<a href="https://github.com/alexgorbatchev/npm-awesome-site">Fork on GitHub to contribute</a></div></div><div class="row"><div class="main col"><article><header><h2><a href="/posts/2014-03-06-lockit">lockit</a></h2><div class="meta"><span>posted by <a href="https://github.com/alexgorbatchev">Alex Gorbatchev</a> on March 6th 2014</span><a href="http://npmawesome.com/posts/2014-03-06-lockit#disqus_thread" class="comments"></a><div data-github-repo="zeMirco/lockit" class="github-stars"></div></div></header><div class="content"><div class="highlight nodejitsu"><img src="/images/posts/nodejitsu.png" style="height: 80px" class="hide-on-mobile"/><span>This post was written for <a href="http://nodejitsu.com">Nodejitsu</a> blog and is crossposted here.
<a href="http://nodejitsu.com">Nodejitsu</a> loved what I was doing at <a href="http://npmawesome.com">npmawesome.com</a>
and is now supporting the project.</span></div><p>So you got a really cool idea for an app or a service. You get all fired up, talk to your friends about, write down some bullet points and run that exciting <code>git init</code> command in an empty folder. One of the first things you are most likely to in the very near future is begin working on some kind of user login and registration process.</p>
<p><img class="hide-on-mobile" src="https://1.gravatar.com/avatar/5664d023c8ab7b6eb69a93990198432e" style="float: right; margin-left: 1em"/>
Of course, <a href="http://passportjs.org/">passport.js</a> is great when you can leverage external authentication, but otherwise you are stuck rolling your own systemâ€¦ After a while you find yourself doing it over and over again. How boring! Wouldn&#39;t it be nice if somebody finally just wrote a module that you could plugin into your express app that would take care of all this user registration stuff?</p>
<p>Well, look no further than <a href="https://github.com/zeMirco/lockit">lockit</a>, which is a collection of modules written by <a href="https://github.com/zeMirco">Mirco Zeiss</a> that helps you with initial user registraion and password management flow.</p>
<pre><code>npm install lockit
</code></pre><h2 id="features">Features</h2>
<ol>
<li>Supports multiple database adapters (MongoDB, CouchDB, SQL).</li>
<li>Sends confirmation emails.</li>
<li>Manages email address verification with verification link expiration.</li>
<li>Brings own Bootstrap based views which are easy to customize.</li>
<li>Account locking after too many failed login attempts.</li>
<li>Events for <code>login</code>, <code>logout</code>, <code>signup</code> and <code>delete</code>.</li>
<li>Implementation of <a href="https://www.owasp.org/index.php/Guide_to_Authentication">lots of</a> <a href="http://stackoverflow.com/questions/549/the-definitive-guide-to-form-based-website-authentication">best</a> <a href="https://www.owasp.org/index.php/Authentication_Cheat_Sheet">pratices</a>.</li>
<li>REST API</li>
<li><a href="http://mircozeiss.com/lockit-050-auth-for-single-page-apps-and-csrf/">Authentication for SPAs and CSRF support</a>.</li>
</ol>
<h2 id="usage">Usage</h2>
<pre><code>var Lockit = require(&#39;lockit&#39;);
var app = express();

// express middleware
// ...
// sessions are required
app.use(express.cookieParser(&#39;your secret here&#39;));
app.use(express.cookieSession());

var config = {
  db: &#39;mongodb://127.0.0.1/test&#39;,
  dbCollection: &#39;users&#39;
};

// use middleware before router so your own routes have access to
// req.session.email and req.session.username
var lockit = new Lockit(app, config);

// you now have all the routes like /login, /signup, etc.
// and you can listen on events. For example &#39;signup&#39;
lockit.on(&#39;signup&#39;, function(user, res) {
  console.log(&#39;a new user signed up&#39;);

  // set signup.handleResponse to &#39;false&#39; for this to work
  res.send(&#39;Welcome!&#39;);
});

app.use(app.router);
// continue with express middleware
// ...
</code></pre><h2 id="emails">Emails</h2>
<p>By default of course emails aren&#39;t being sent. That means that you won&#39;t receive any signup and password reset tokens. To send emails you need an email server and you have pass the right settings:</p>
<p>With <a href="http://www.mailgun.com/pricing">mailgun</a> you can send up to 10,000 emails per month for free. <code>emailSettings</code> - see <a href="https://github.com/andris9/Nodemailer">nodemailer</a> for more information.</p>
<pre><code>config = {
  emailType: &#39;SMTP&#39;,
  emailSettings: {
    service: &#39;Mailgun&#39;,
    auth: {
      user: &#39;postmaster@username.mailgun.org&#39;,
      pass: &#39;secret-password&#39;
    }
  }
}
</code></pre><h2 id="custom-views">Custom views</h2>
<p>Lockit comes with built-in views which are based on Bootstrap. If you want to use your own custom views you can. It is dead simple. Put them into your <code>views</code> folder, for example <code>views/lockit/myLogin.jade</code>.</p>
<pre><code>config = {
  login: {
    route: &#39;/login&#39;,
    logoutRoute: &#39;/logout&#39;,
    views: {
      login: &#39;lockit/myLogin.jade&#39;,
      loggedOut: &#39;lockit/myLogoutSuccess.jade&#39;
    }
  }
}
</code></pre><h2 id="routes-included">Routes included</h2>
<p>From <a href="https://github.com/zeMirco/lockit-signup">lockit-signup</a></p>
<ul>
<li>GET /signup</li>
<li>POST /signup</li>
<li>GET /signup/:token</li>
<li>GET /signup/resend-verification</li>
<li>POST /signup/resend-verification</li>
</ul>
<p>From <a href="https://github.com/zeMirco/lockit-login">lockit-login</a></p>
<ul>
<li>GET /login</li>
<li>POST /login</li>
<li>GET /logout</li>
</ul>
<p>From <a href="https://github.com/zeMirco/lockit-forgot-password">lockit-forgot-password</a></p>
<ul>
<li>GET /forgot-password</li>
<li>POST /forgot-password</li>
<li>GET /forgot-password/:token</li>
<li>POST /forgot-password/:token</li>
</ul>
<p>From <a href="https://github.com/zeMirco/lockit-delete-account">lockit-delete-account</a></p>
<ul>
<li>GET /delete-account</li>
<li>POST /delete-account</li>
</ul>
<h2 id="closing-thoughts">Closing thoughts</h2>
<p>I love how customizable <a href="https://github.com/zeMirco/lockit">lockit</a> is and yet comes with very reasonable defaults. It&#39;s has pretty much everything you need to get started with basic user registration and password management flow. Checkout <a href="https://github.com/zeMirco/lockit">lockit</a> github page for full set of options as well as its associated modules.</p>
</div></article><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'npmawesome'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script></div><aside class="col"><div class="feedburner"><a href="http://feeds.feedburner.com/npmawesome"><img src="/images/feed.gif"></a></div><div class="other-posts"><h4>Previously...</h4><div><a href="/posts/2014-03-28-cli-table" class="partner nodejitsu">cli-table</a></div><div><a href="/posts/2014-03-21-yargs" class="partner nodejitsu">yargs</a></div><div><a href="/posts/2014-03-12-convict" class="partner nodejitsu">convict</a></div><div><a href="/posts/2014-03-06-lockit" class="current partner nodejitsu">lockit</a></div><div><a href="/posts/2014-02-27-qr-image" class="partner nodejitsu">qr-image</a></div><div><a href="/posts/2014-02-25-webdriverjs">webdriver.js</a></div><div><a href="/posts/2014-02-24-pretty-error">pretty-error</a></div><div><a href="/posts/2014-02-21-supertest">supertest</a></div><div><a href="/posts/2014-02-20-spritesmith">spritesmith</a></div><div><a href="/posts/2014-02-19-9-gulp-js-plugins-for-a-great-build-system" class="partner nodejitsu">9 gulp.js plugins for a great build system</a></div><div><a href="/posts/2014-02-18-npm-diff">npm-diff</a></div><div><a href="/posts/2014-02-17-nodepdf">NodePDF</a></div><div><a href="/posts/2014-02-13-domain-context">domain-context</a></div><div><a href="/posts/2014-02-12-jsonstream">JSONStream</a></div><div><a href="/posts/2014-02-11-peer-js">peer.js</a></div><div><a href="/posts/2014-02-10-node-dependencies">node-dependencies</a></div><div><a href="/posts/2014-02-05-cucumber-js">cucumber.js</a></div><div><a href="/posts/2014-02-04-binary-js">binary.js</a></div><div><a href="/posts/2014-02-03-power-assert">power-assert</a></div><div><a href="/posts/2014-01-31-coupon-code">coupon-code</a></div><div><a href="/posts/2014-01-30-rewire">rewire</a></div><div><a href="/posts/2014-01-29-yarm">yarm</a></div><div><a href="/posts/2014-01-28-modella">modella</a></div><div><a href="/posts/2014-01-27-mversion">mversion</a></div><div><a href="/posts/2014-01-24-schema-inspector">schema-inspector</a></div><div><a href="/posts/2014-01-23-oboe-js">oboe.js</a></div><div><a href="/posts/2014-01-22-autoprefixer">autoprefixer</a></div><div><a href="/posts/2014-01-21-js-yaml">js-yaml</a></div><div><a href="/posts/2014-01-17-gaze">gaze</a></div><div><a href="/posts/2014-01-14-shortid">shortId</a></div><div><a href="/posts/2014-01-13-testium">testium</a></div><div><a href="/posts/2014-01-10-messageformat">messageformat.js</a></div><div><a href="/posts/2014-01-09-gulp">gulp</a></div><div><a href="/posts/2014-01-06-chalk">chalk</a></div><div><a href="/posts/2013-12-31-recluster">recluster</a></div><div><a href="/posts/2013-12-30-rework">rework</a></div><div><a href="/posts/2013-12-27-cheerio">cheerio</a></div><div><a href="/posts/2013-12-19-dat">dat</a></div><div><a href="/posts/2013-12-18-xregexp">xregexp</a></div><div><a href="/posts/2013-12-17-npm">npm v1.3.18</a></div><div><a href="/posts/2013-12-16-ect">ect</a></div><div><a href="/posts/2013-12-13-chrono">chrono</a></div><div><a href="/posts/2013-12-11-prettyjson">prettyjson</a></div><div><a href="/posts/2013-12-10-state">state</a></div><div><a href="/posts/2013-12-09-blessed">blessed</a></div><div><a href="/posts/2013-12-05-gm">gm</a></div><div><a href="/posts/2013-12-03-nak">nak</a></div><div><a href="/posts/2013-12-03-verymodel">VeryModel</a></div><div><a href="/posts/2013-11-30-scala-js">scala.js</a></div><div><a href="/posts/2013-11-27-scale-npm">scalenpm.org</a></div><div><a href="/posts/2013-11-26-rx-js">rx.js</a></div><div><a href="/posts/2013-11-26-docpad">docpad</a></div><div><a href="/posts/2013-11-25-grunt-angular-builder">grunt-angular-builder</a></div><div><a href="/posts/2013-11-22-videoconverter-js">videoconverter.js</a></div><div><a href="/posts/2013-11-22-event-stream">event-stream</a></div><div><a href="/posts/2013-11-21-bacon-js">bacon.js</a></div><div><a href="/posts/2013-11-20-spdy">node-spdy</a></div><div><a href="/posts/2013-11-19-json-mask">json-mask</a></div><div><a href="/posts/2013-11-18-pm2">pm2</a></div><div><a href="/posts/2013-11-18-npmd">npmd</a></div><div><a href="/posts/2013-11-18-nixt">nixt</a></div><div><a href="/posts/2013-11-17-vm-js">vm.js</a></div><div><a href="/posts/2013-11-17-node-jvm">node-jvm</a></div><div><a href="/posts/2013-11-17-flake">flake</a></div></div></aside></div></div><a id="fork-me" href="https://github.com/alexgorbatchev/npm-awesome-site" class="hide-on-mobile">Fork Me</a></body><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

// http://drawingablank.me/blog/fix-your-bounce-rate.html
// https://news.ycombinator.com/item?id=5766883
setTimeout(function() { ga('send', 'event', 'read', 'auto generated'); }, 5000);

ga('create', 'UA-46164085-1', 'npmawesome.com');
ga('send', 'pageview');
</script><script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="/scripts/npmawesome.bundle.js"></script>