<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xmlns:fb="https://www.facebook.com/2008/fbml"><head><meta charset="utf-8"><link rel="alternate" title="RSS" type="application/rss+xml" href="http://feeds.feedburner.com/npmawesome"><link href="http://npmawesome.com/atom.xml" title="Blog Posts" type="application/atom+xml" rel="alternate"><link rel="stylesheet" type="text/css" media="all" href="/styles.css"><meta name="viewport" content="initial-scale=1, maximum-scale=1"><meta property="twitter:account_id" content="4503599628039784"><meta property="fb:app_id" content="1425631694354948"><title>mag</title><meta property="og:title" content="npm awesome"><meta property="og:image" content="http://npmawesome.com/images/posts/npmawesome-logo-512x512.png"><meta property="og:updated_time" content="1404838978000"><meta property="og:site_name" content="npm awesome"><meta property="og:type" content="article"><meta property="og:url" content="http://npmawesome.com/posts/2014-07-08-mag"><meta property="og:description" content="Mag is the streaming logger for Node.js"><link rel="canonical" href="http://npmawesome.com/posts/2014-07-08-mag"><meta name="description" content="Mag is the streaming logger for Node.js"></head></html><body><header id="page-header"><div class="container"><div class="row"><h1 id="logo"><a href="/"><span class="name">npmawesome</span><span class="posts-counter">106</span></a></h1><div id="sub-title"><a href="http://npmjs.org">npm</a> picks, old and new.
<a href="https://github.com/alexgorbatchev/npm-awesome-site">Fork on GitHub to contribute</a></div></div></div></header><div class="container"><div class="row"><div class="main col"><article><header><h2 class="npm"><a href="/posts/2014-07-08-mag">mag</a></h2><div class="meta"><span>posted by <a href="https://github.com/mahnunchik">Eugeny Vlasenko</a> on July 8th 2014</span><a href="http://npmawesome.com/posts/2014-07-08-mag#disqus_thread" class="comments"></a><div data-github-repo="mahnunchik/mag" class="github-stars"></div></div><div class="social-box"><div data-yashareLink="http://npmawesome.com/posts/2014-07-08-mag" data-yashareL10n="en" data-yashareQuickServices="facebook,twitter,gplus" data-yashareTheme="counter" data-yasharetype-off="small" class="yashare-auto-init"></div></div></header><div class="content"><p><img src="https://avatars0.githubusercontent.com/u/780935?s=400" width="100" align="right"/>
My name is <a href="https://github.com/mahnunchik">Eugeny Vlasenko</a> and I want to introduce my logging module called <a href="http://browsenpm.org/package/mag">mag</a> (GitHub: <a href="https://github.com/mahnunchik/mag">mahnunchik/mag</a>, License: MIT). There are lots of full-featured logging frameworks such as <a href="http://browsenpm.org/package/bunyan">Bunyan</a> [GitHub: <a href="https://github.com/trentm/node-bunyan">trentm/node-bunyan</a>, License: MIT) <a href="http://browsenpm.org/package/node-bunyan">Winston</a> (GitHub: <a href="https://github.com/flatiron/winston">flatiron/winston</a>, License: MIT) or <a href="http://browsenpm.org/package/log4js">log4js</a> (GitHub: <a href="https://github.com/nomiddlename/log4js-node, License: MIT">nomiddlename/log4js-node</a>. Why write another one? Personally, I subscribe to the <a href="http://12factor.net">twelve-factor app methodology</a> and more specifically <a href="http://12factor.net/logs">the part about logs</a>. Another cool thing about <code>mag</code> is that it’s fully built on <a href="https://www.npmjs.org/package/readable-stream">Streams3</a>.</p>
<div class="read-more"></div>

<h2 id="installation">Installation</h2>
<pre><code>npm install mag
</code></pre><h2 id="twelve-factor-app-logging">Twelve-factor app logging</h2>
<ul>
<li>Logs are the stream of time-ordered events.</li>
<li>App never concerns itself with routing or storage of its output stream.</li>
<li>App should not attempt to write to or manage logfiles.</li>
<li>App should write its event stream, unbuffered, to stdout.</li>
</ul>
<h2 id="here-s-how-to-use-mag">Here’s how to use Mag</h2>
<h3 id="step-1">Step 1</h3>
<p>When you start developing an application you do not want to spend time configuring the logger, you just want be building features. You can just require <code>mag</code> (one line more than console usage =) and use it:</p>
<pre><code>var logger = require(&#39;mag&#39;)();
logger.info(&#39;my great application is running!&#39;);

// 01:27:36.427 &lt;INFORMATIONAL&gt; my great application is running!
</code></pre><p>You get a well formatted message with a timestamp. Done!</p>
<h3 id="step-2">Step 2</h3>
<p>When your application begins to grow and you want to visually separate messages from different parts of application, you can start using the namespaces feature of <code>mag</code>.</p>
<pre><code>var mag = require(&#39;mag&#39;);

var logger = mag(&#39;my-app&#39;);
var libLogger = mag(&#39;my-lib&#39;);

logger.info(&#39;my great application is running&#39;);
libLogger.debug(&#39;my library is running too&#39;);

// 22:36:24.245 [my-app] &lt;INFORMATIONAL&gt; my great application is running
// 22:36:24.246 [my-lib] &lt;DEBUG&gt; my library is running too
</code></pre><h3 id="step-3">Step 3</h3>
<p>When your application is finally ready for production, it is time to think about the logging format. Should it be text line by line? Maybe JSON?. Should entire error stack be printed or only a few lines? At this time you can require <code>mag-hub</code> module and configure the message format once in your application:</p>
<pre><code>var hub = require(&#39;mag-hub&#39;);

// Formatters
var info = require(&#39;mag-process-info&#39;);
var format = require(&#39;mag-format-message&#39;);
var colored = require(&#39;mag-colored-output&#39;);

var myCustomFormatter = require(&#39;./my-custom-formatter.js&#39;);

hub.pipe(info())
  .pipe(format())
  .pipe(myCustomFormatter())
  .pipe(colored())
  .pipe(process.stdout);
</code></pre><h2 id="how-it-works">How it works</h2>
<ol>
<li><code>mag</code> requires <code>mag-stream</code> module as a output for its log objects</li>
<li><code>mag-stream</code> tries to require top level <code>mag-hub</code> module</li>
<li>if it fails then <code>mag-stream</code> requires <code>mag-fallback</code></li>
<li><code>mag-fallback</code> is the fallback formatter which is essentially the same as using a <code>console</code> with a timestamp.</li>
</ol>
<p>Mag does not come bundled with any transports, even formatters are in separate modules. You could potentially make log management based on mag, but I recommend sticking with the <a href="http://12factor.net/logs">twelve-factor app</a> methodology again and keep it simple. Use a log collector from Splunk or Loggly to drain the syslog instead.</p>
<h2 id="related-modules">Related Modules</h2>
<ul>
<li><a href="http://browsenpm.org/package/mag-logger-facade">mag-logger-facade</a> (GitHub: <a href="https://github.com/manhunchik/mag-logger-facade">mahnunchik/mag-logger-facade</a>, License: MIT)</li>
<li><a href="http://browsenpm.org/package/mag-stream">mag-stream</a> (GitHub: <a href="https://github.com/manhunchik/mag-stream">mahnunchik/mag-stream</a>, License: MIT)</li>
<li><a href="http://browsenpm.org/package/mag-hub">mag-hub</a> (GitHub: <a href="https://github.com/manhunchik/mag-hub">mahnunchik/mag-hub</a>, License: MIT)</li>
<li><a href="http://browsenpm.org/package/mag-fallback">mag-fallback</a> (GitHub: <a href="https://github.com/manhunchik/mag-fallback">mahnunchik/mag-fallback</a>, License: MIT)</li>
</ul>
<div class="social-box"><div data-yashareLink="http://npmawesome.com/posts/2014-07-08-mag" data-yashareL10n="en" data-yashareQuickServices="facebook,twitter,gplus" data-yashareTheme="counter" data-yasharetype-off="small" class="yashare-auto-init"></div></div></div></article><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'npmawesome'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script></div><aside class="col"><div class="feedburner"><a href="http://feeds.feedburner.com/npmawesome"><img src="/images/feed.gif"></a></div><div class="other-posts"><h4>Previously...</h4><div><a href="/posts/2014-07-09-colorguard" class="partner nodejitsu">colorguard</a></div><div><a href="/posts/2014-07-08-mag" class="current">mag</a></div><div><a href="/posts/2014-07-03-links">Links for July 3, 2014</a></div><div><a href="/posts/2014-07-01-ten-open-source-nodejs-apps" class="partner nodejitsu">Ten open source Node.js apps</a></div><div><a href="/posts/2014-06-30-links">Links for June 30, 2014</a></div><div><a href="/posts/2014-06-26-songbird" class="partner nodejitsu">songbird</a></div><div><a href="/posts/2014-06-24-comparing-winston-and-bunyan-node-js-logging" class="partner strongloop">Comparing Winston and Bunyan Node.js Logging</a></div><div><a href="/posts/2014-06-17-links">Links for June 17, 2014</a></div><div><a href="/posts/2014-06-16-jugglingdb" class="partner nodejitsu">JugglingDB</a></div><div><a href="/posts/2014-06-06-links">Links for June 6, 2014</a></div><div><a href="/posts/2014-05-29-links">Links for May 29, 2014</a></div><div><a href="/posts/2014-05-23-joi" class="partner nodejitsu">joi</a></div><div><a href="/posts/2014-05-23-changelog">changelog</a></div><div><a href="/posts/2014-05-22-links">Links for May 22, 2014</a></div><div><a href="/posts/2014-05-20-links">Links for May 20, 2014</a></div><div><a href="/posts/2014-05-16-longjohn" class="partner nodejitsu">longjohn</a></div><div><a href="/posts/2014-05-16-links">Links for May 16, 2014</a></div><div><a href="/posts/2014-05-14-links">Links for May 14, 2014</a></div><div><a href="/posts/2014-05-13-links">Links for May 13, 2014</a></div><div><a href="/posts/2014-05-06-agenda" class="partner nodejitsu">agenda</a></div><div><a href="/posts/2014-05-06-links">Links for May 6, 2014</a></div><div><a href="/posts/2014-05-01-google-distance">google-distance</a></div><div><a href="/posts/2014-04-30-links">Links for Apr 30, 2014</a></div><div><a href="/posts/2014-04-30-sentiment" class="partner nodejitsu">sentiment</a></div><div><a href="/posts/2014-04-29-compare-express-restify-hapi-loopback" class="partner strongloop">Comparing Express, Restify, hapi and LoopBack for building RESTful APIs</a></div><div><a href="/posts/2014-04-28-angular-injector">angular-injector</a></div><div><a href="/posts/2014-04-23-platform-js">platform.js</a></div><div><a href="/posts/2014-04-23-links">Links for Apr 23, 2014</a></div><div><a href="/posts/2014-04-19-links">Links for Apr 19, 2014</a></div><div><a href="/posts/2014-04-18-links">Links for Apr 18, 2014</a></div><div><a href="/posts/2014-04-18-terminal-menu" class="partner nodejitsu">terminal-menu</a></div><div><a href="/posts/2014-04-17-links">Links for Apr 17, 2014</a></div><div><a href="/posts/2014-04-16-promises-trycatch-zones" class="partner strongloop">Comparing Node.js Promises, Try/Catch, Angular Zone.js and yes, Zone</a></div><div><a href="/posts/2014-04-15-links">Links for Apr 15, 2014</a></div><div><a href="/posts/2014-04-11-links">Links for Apr 10, 2014</a></div><div><a href="/posts/2014-04-10-shmock">shmock</a></div><div><a href="/posts/2014-04-09-links">Links for Apr 8, 2014</a></div><div><a href="/posts/2014-04-07-links">Links for Apr 7, 2014</a></div><div><a href="/posts/2014-04-04-links">Links for Apr 5, 2014</a></div><div><a href="/posts/2014-04-04-progress" class="partner nodejitsu">progress</a></div><div><a href="/posts/2014-04-04-slate-irc">slate-irc</a></div><div><a href="/posts/2014-04-03-links">Links for Apr 4, 2014</a></div><div><a href="/posts/2014-03-28-cli-table" class="partner nodejitsu">cli-table</a></div><div><a href="/posts/2014-03-21-yargs" class="partner nodejitsu">yargs</a></div><div><a href="/posts/2014-03-12-convict" class="partner nodejitsu">convict</a></div><div><a href="/posts/2014-03-06-lockit" class="partner nodejitsu">lockit</a></div><div><a href="/posts/2014-02-27-qr-image" class="partner nodejitsu">qr-image</a></div><div><a href="/posts/2014-02-25-webdriverjs">webdriverjs</a></div><div><a href="/posts/2014-02-24-pretty-error">pretty-error</a></div><div><a href="/posts/2014-02-21-supertest">supertest</a></div><div><a href="/posts/2014-02-20-spritesmith">spritesmith</a></div><div><a href="/posts/2014-02-19-9-gulp-js-plugins-for-a-great-build-system" class="partner nodejitsu">9 gulp.js plugins for a great build system</a></div><div><a href="/posts/2014-02-18-npm-diff">npm-diff</a></div><div><a href="/posts/2014-02-17-nodepdf">nodepdf</a></div><div><a href="/posts/2014-02-13-domain-context">domain-context</a></div><div><a href="/posts/2014-02-12-jsonstream">jsonstream</a></div><div><a href="/posts/2014-02-11-peer-js">peerjs</a></div><div><a href="/posts/2014-02-10-node-dependencies">node-dependencies</a></div><div><a href="/posts/2014-02-05-cucumber-js">cucumber</a></div><div><a href="/posts/2014-02-04-binary-js">binaryjs</a></div><div><a href="/posts/2014-02-03-power-assert">power-assert</a></div><div><a href="/posts/2014-01-31-coupon-code">coupon-code</a></div><div><a href="/posts/2014-01-30-rewire">rewire</a></div><div><a href="/posts/2014-01-29-yarm">yarm</a></div><div><a href="/posts/2014-01-28-modella">modella</a></div><div><a href="/posts/2014-01-27-mversion">mversion</a></div><div><a href="/posts/2014-01-24-schema-inspector">schema-inspector</a></div><div><a href="/posts/2014-01-23-oboe-js">oboe</a></div><div><a href="/posts/2014-01-22-autoprefixer">autoprefixer</a></div><div><a href="/posts/2014-01-21-js-yaml">js-yaml</a></div><div><a href="/posts/2014-01-17-gaze">gaze</a></div><div><a href="/posts/2014-01-14-shortid">shortId</a></div><div><a href="/posts/2014-01-13-testium">testium</a></div><div><a href="/posts/2014-01-10-messageformat">messageformat</a></div><div><a href="/posts/2014-01-09-gulp">gulp</a></div><div><a href="/posts/2014-01-06-chalk">chalk</a></div><div><a href="/posts/2013-12-31-recluster">recluster</a></div><div><a href="/posts/2013-12-30-rework">rework</a></div><div><a href="/posts/2013-12-27-cheerio">cheerio</a></div><div><a href="/posts/2013-12-19-dat">dat</a></div><div><a href="/posts/2013-12-18-xregexp">xregexp</a></div><div><a href="/posts/2013-12-17-npm">npm v1.3.18</a></div><div><a href="/posts/2013-12-16-ect">ect</a></div><div><a href="/posts/2013-12-13-chrono">chrono-node</a></div><div><a href="/posts/2013-12-11-prettyjson">prettyjson</a></div><div><a href="/posts/2013-12-10-state">state</a></div><div><a href="/posts/2013-12-09-blessed">blessed</a></div><div><a href="/posts/2013-12-05-gm">gm</a></div><div><a href="/posts/2013-12-03-nak">nak</a></div><div><a href="/posts/2013-12-03-verymodel">verymodel</a></div><div><a href="/posts/2013-11-30-scala-js">scala.js</a></div><div><a href="/posts/2013-11-27-scale-npm">scalenpm.org</a></div><div><a href="/posts/2013-11-26-rx-js">rx</a></div><div><a href="/posts/2013-11-26-docpad">docpad</a></div><div><a href="/posts/2013-11-25-grunt-angular-builder">grunt-angular-builder</a></div><div><a href="/posts/2013-11-22-videoconverter-js">videoconverter.js</a></div><div><a href="/posts/2013-11-22-event-stream">event-stream</a></div><div><a href="/posts/2013-11-21-bacon-js">baconjs</a></div><div><a href="/posts/2013-11-20-spdy">spdy</a></div><div><a href="/posts/2013-11-19-json-mask">json-mask</a></div><div><a href="/posts/2013-11-18-pm2">pm2</a></div><div><a href="/posts/2013-11-18-npmd">npmd</a></div><div><a href="/posts/2013-11-18-nixt">nixt</a></div><div><a href="/posts/2013-11-17-vm-js">vm.js</a></div><div><a href="/posts/2013-11-17-node-jvm">node-jvm</a></div><div><a href="/posts/2013-11-17-flake">flake</a></div></div></aside></div></div><a id="fork-me" href="https://github.com/alexgorbatchev/npm-awesome-site" class="hide-on-mobile">Fork Me</a><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

// http://drawingablank.me/blog/fix-your-bounce-rate.html
// https://news.ycombinator.com/item?id=5766883
setTimeout(function() { ga('send', 'event', 'read', 'auto generated'); }, 5000);

ga('create', 'UA-46164085-1', 'npmawesome.com');
ga('send', 'pageview');
</script><script>/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'npmawesome'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script><script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script async src="/scripts/npmawesome.min.js"></script><script async src="//platform.twitter.com/widgets.js"></script><script async src="//yandex.st/share/share.js"></script></body>